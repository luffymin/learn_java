<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8"/>
		<title>websocket to cmpp</title>
	</head>
	<body>
		id: <input type="text" name="" id="id" value=""/></br>
		host: <input type="text" name="" id="host" value=""/></br>
		port: <input type="text" name="" id="port" value=""/></br>
		spCode: <input type="text" name="" id="spCode" value=""/></br>
		serviceId: <input type="text" name="" id="serviceId" value=""/></br>
		msgSrc: <input type="text" name="" id="msgSrc" value=""/></br>
		version: <input type="text" name="" id="version" value=""/></br>
		userName: <input type="text" name="" id="userName" value=""/></br>
		password: <input type="text" name="" id="password" value=""/></br>
		<button type="button" id="connect">connect</button></br>
		</br>
		msgContent: <input type="text" name="" id="msgContent" value=""/></br>
		destterminalId: <input type="text" name="" id="destterminalId" value=""/></br>
		<button type="button" id="submit">submit</button></br>
		<div id="response"></div>
	</body>
</html>
<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script type="text/javascript">
	var ws = new WebSocket("ws://127.0.0.1:8080/cmpp");

	ws.onopen = function() {
		document.getElementById('response').innerHTML="连接已打开";
	};

	$('#connect').click(function() {
		var obj = new Object();
		obj.command = "CMPP_CONNECT";
		obj.id = $('#id').val();
		obj.host = $('#host').val();
		obj.port = $('#port').val();
		obj.spCode = $('#spCode').val();
		obj.serviceId = $('#serviceId').val();
		obj.msgSrc = $('#msgSrc').val();
		obj.version = $('#version').val();
		obj.userName = $('#userName').val();
		obj.password = $('#password').val();
		s = JSON.stringify(obj);
		console.log(s);
		ws.send(s);
	})

	$('#submit').click(function() {
		var obj = new Object();
		obj.command = "CMPP_SUBMIT";
		obj.msgContent = $('#msgContent').val();
		obj.destterminalId = $('#destterminalId').val();
		s = JSON.stringify(obj);
		console.log(s);
		ws.send(s);
	})

	ws.onmessage = function (evt) {
		console.log(evt.data);
		$('#response').text(evt.data);
	};
	
	ws.onclose = function() {
		alert("连接已关闭"); 
	};

</script>
